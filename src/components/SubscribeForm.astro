---
import { getLocaleFromUrl, t } from '@/lib/i18n';

interface Props {
  variant?: 'compact' | 'full';
}

const { variant = 'full' } = Astro.props;
const locale = getLocaleFromUrl(Astro.url);
// Official follow.it subscription form endpoint
const actionUrl = 'https://api.follow.it/subscription-form/bkFIU3hVQWlyZ1Y0TWlVcW5OODQzM282SEtjdWxkbkVUd2NRSG04SExVY1ZnTzAwQTZHMEhtZkRaMFUyTm1qdlhzMUlkNEtWcW11M0tHQVd0cHRhYWpWelloenZrbHgzVGFQTmFSUVkzVWVJRDduMFBRNUNRd3ZDMXBMYUs4aEZ8czVobHh2T2ZubDhzUkQ1YkgwbXNsTWJIMk90djFKSkhrZ1YrYmw0dERFUT0=/8';
---

<div class={`subscribe-form subscribe-form--${variant}`}>
  <form action={actionUrl} method="POST" target="_blank" class="subscribe-form__form">
    {variant === 'full' && <p class="subscribe-form__text">{t(locale, 'subscribe.cta')}</p>}
    <div class="subscribe-form__input-group">
      <input
        type="email"
        name="email"
        placeholder={t(locale, 'subscribe.placeholder')}
        required
        class="subscribe-form__input"
        aria-label={t(locale, 'subscribe.placeholder')}
      />
      <button type="submit" class="subscribe-form__button">
        {t(locale, 'subscribe.button')} <span aria-hidden="true">â†—</span>
      </button>
    </div>
    <p class="subscribe-form__hint">{t(locale, 'subscribe.hint')}</p>
  </form>
</div>

<style>
  .subscribe-form {
    width: 100%;
  }

  .subscribe-form--compact {
    margin: 1.5rem 0;
  }

  .subscribe-form--full {
    margin: 2rem 0;
    padding: 1.5rem;
    background: var(--pico-card-background-color);
    border-radius: var(--pico-border-radius);
  }

  .subscribe-form__text {
    margin-bottom: 1rem;
    color: var(--pico-muted-color);
  }

  .subscribe-form__input-group {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .subscribe-form__input {
    flex: 1;
    min-width: 200px;
    margin-bottom: 0;
  }

  .subscribe-form__button {
    margin-bottom: 0;
    white-space: nowrap;
  }

  .subscribe-form__hint {
    margin-top: 0.5rem;
    margin-bottom: 0;
    font-size: 0.875rem;
    color: var(--pico-muted-color);
  }

  @media (max-width: 576px) {
    .subscribe-form__input-group {
      flex-direction: column;
    }

    .subscribe-form__input {
      min-width: 100%;
    }

    .subscribe-form__button {
      width: 100%;
    }
  }
</style>
